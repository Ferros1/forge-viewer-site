<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Forge Viewer â€“ Projekt1</title>
  <script src="https://developer.api.autodesk.com/modelderivative/v2/viewers/7.*/viewer3D.min.js"></script>
  <link rel="stylesheet" href="https://developer.api.autodesk.com/modelderivative/v2/viewers/7.*/style.min.css">
  <style>
    html, body { margin: 0; height: 100%; }
    #forgeViewer { width: 100%; height: 100vh; }
  </style>
</head>
<body>
  <div id="forgeViewer"></div>
  <script>
    const TOKEN_URL = 'https://forge-token-server.onrender.com/api/token';
    const URN = 'urn:dXJuOmFkc2sub2JqZWN0czpvcy5vYmplY3Q6YXV5YmtsbjloeG9jdW5tN2ZzN2l4b3B2cm14eTFwenJ0bzB6d3J3ZWx3aHVxbXQ4LWJhc2ljLWFwcC9Qcm9qZWt0MS5ydnQ';

    async function getForgeToken(callback) {
      try {
        const response = await fetch(TOKEN_URL);
        const { access_token, expires_in } = await response.json();
        callback(access_token, expires_in);
      } catch (error) {
        console.error('Failed to get access token:', error);
      }
    }

    const options = {
      env: 'AutodeskProduction',
      getAccessToken: getForgeToken
    };

    Autodesk.Viewing.Initializer(options, function () {
      const viewerDiv = document.getElementById('forgeViewer');
      const viewer = new Autodesk.Viewing.GuiViewer3D(viewerDiv);
      viewer.start();

      Autodesk.Viewing.Document.load(URN, function (doc) {
        const geometry = doc.getRoot().getDefaultGeometry();
        viewer.loadDocumentNode(doc, geometry);
      }, function (err) {
        console.error('Could not load document:', err);
      });
    });
  </script>
</body>
</html>
